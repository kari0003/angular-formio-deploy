!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("formiojs"),require("lodash/each"),require("lodash/intersection"),require("angular-formio"),require("angular-formio/auth"),require("angular-formio/grid"),require("lodash"),require("@angular/router"),require("@angular/common"),require("@angular/forms"),require("ngx-bootstrap/modal"),require("ngx-bootstrap/pagination")):"function"==typeof define&&define.amd?define("angular-formio/manager",["exports","@angular/core","formiojs","lodash/each","lodash/intersection","angular-formio","angular-formio/auth","angular-formio/grid","lodash","@angular/router","@angular/common","@angular/forms","ngx-bootstrap/modal","ngx-bootstrap/pagination"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["angular-formio"]=e["angular-formio"]||{},e["angular-formio"].manager={}),e.ng.core,e.formiojs,e._each,e._intersection,e["angular-formio"],e["angular-formio"].auth,e["angular-formio"].grid,e._,e.ng.router,e.ng.common,e.ng.forms,e["ngx-bootstrap/modal"],e["ngx-bootstrap/pagination"])}(this,(function(e,t,r,n,o,i,a,s,c,l,m,u,f,d){"use strict";function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h=p(n),v=p(o),g=p(c),y=function(){this.tag="",this.includeSearch=!1,this.saveDraft=!1};y.ɵfac=function(e){return new(e||y)},y.ɵprov=t.ɵɵdefineInjectable({token:y,factory:y.ɵfac});var b=function(){function e(e,t,n){var o=this;this.appConfig=e,this.config=t,this.auth=n,this.form=null,this.perms={delete:!1,edit:!1},this.appConfig&&this.appConfig.appUrl?(r.Formio.setBaseUrl(this.appConfig.apiUrl),r.Formio.setProjectUrl(this.appConfig.appUrl)):console.error("You must provide an AppConfig within your application!"),this.allAccessMap={update_all:"formEdit",delete_all:"formDelete"},this.ownAccessMap={update_own:"formEdit",delete_own:"formDelete"},this.actionAllowed=function(e){return o.isActionAllowed(e)},this.reset()}return e.prototype.isActionAllowed=function(e){return this.access[e]},e.prototype.setAccess=function(){var e=this;this.access={formCreate:!0,formView:!0,formEdit:!0,formDelete:!0,submissionIndex:!0},this.auth?(this.access={formCreate:!1,formView:!1,formEdit:!1,formDelete:!1,submissionIndex:!1},this.ready=this.auth.ready.then((function(){var t=[];h.default(e.auth.roles,(function(e,r){e.admin&&t.push(e._id)})),e.auth.user&&e.auth.user.roles&&e.auth.user.roles.forEach((function(r){-1!==t.indexOf(r)&&(e.access.formCreate=!0,e.access.formView=!0,e.access.formEdit=!0,e.access.formDelete=!0,e.access.submissionIndex=!0),e.access.formCreate||(e.access.formCreate=-1!==e.auth.formAccess.create_all.indexOf(r)),e.access.formView||(e.access.formView=-1!==e.auth.formAccess.read_all.indexOf(r)),e.access.formEdit||(e.access.formEdit=-1!==e.auth.formAccess.update_all.indexOf(r)),e.access.formDelete||(e.access.formDelete=-1!==e.auth.formAccess.delete_all.indexOf(r)),e.access.submissionIndex||(e.access.submissionIndex=-1!==e.auth.formAccess.read_all.indexOf(r))}))}))):this.ready=Promise.resolve(!1)},e.prototype.reset=function(e){var t=this;e?e.params.subscribe((function(e){e.id?t.formio=new r.Formio(t.formio.formsUrl+"/"+e.id):t.reset()})):(this.formio=new r.Formio(this.appConfig.appUrl),this.setAccess())},e.prototype.hasAccess=function(e){return!!this.auth.user&&!!v.default(e,this.auth.user.roles).length},e.prototype.setForm=function(e){var t=this;return this.form=e,e.access&&e.access.forEach((function(r){t.allAccessMap[r.type]&&!t.access[t.allAccessMap[r.type]]&&(t.access[t.allAccessMap[r.type]]=t.hasAccess(r.roles)),t.auth&&t.auth.user&&e._id===t.auth.user._id&&t.ownAccessMap[r.type]&&!t.access[t.ownAccessMap[r.type]]&&(t.access[t.ownAccessMap[r.type]]=t.hasAccess(r.roles))})),e},e.prototype.loadForm=function(){var e=this;return this.formio.loadForm().then((function(t){return e.setForm(t)}))},e.prototype.setSubmission=function(e){var t=this;return new Promise((function(n){e.params.subscribe((function(e){t.formio=new r.Formio(t.formio.submissionsUrl+"/"+e.id),n(t.formio)}))}))},e.prototype.submissionLoaded=function(e){var t=this;this.auth.ready.then((function(){t.formio.userPermissions(t.auth.user,t.form,e).then((function(e){t.perms.delete=e.delete,t.perms.edit=e.edit}))}))},e.prototype.loadForms=function(){return this.formio.loadForms({params:{tags:this.config.tag}})},e.prototype.createForm=function(e){return this.formio.createform(e)},e}();function S(e,r){if(1&e){var n=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"span",5),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(n),t.ɵɵnextContext(2).clearSearch()})),t.ɵɵelement(1,"span",6),t.ɵɵelementEnd()}}function w(e,r){if(1&e){var n=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",2),t.ɵɵelementStart(1,"input",3),t.ɵɵlistener("keyup",(function(){return t.ɵɵrestoreView(n),t.ɵɵnextContext().onSearch()}))("ngModelChange",(function(e){return t.ɵɵrestoreView(n),t.ɵɵnextContext().search=e})),t.ɵɵelementEnd(),t.ɵɵtemplate(2,S,2,0,"span",4),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵproperty("ngModel",o.search),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",o.search&&""!==o.search)}}function x(e,r){if(1&e){var n=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"formio-grid",7),t.ɵɵlistener("rowAction",(function(e){return t.ɵɵrestoreView(n),t.ɵɵnextContext().onAction(e)}))("rowSelect",(function(e){return t.ɵɵrestoreView(n),t.ɵɵnextContext().onSelect(e)}))("createItem",(function(){return t.ɵɵrestoreView(n),t.ɵɵnextContext().onCreateItem()})),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext();t.ɵɵproperty("formio",o.service.formio)("gridType","form")("query",o.gridQuery)("refresh",o.refreshGrid)("isActionAllowed",o.service.actionAllowed)}}b.ɵfac=function(e){return new(e||b)(t.ɵɵinject(i.FormioAppConfig),t.ɵɵinject(y),t.ɵɵinject(a.FormioAuthService))},b.ɵprov=t.ɵɵdefineInjectable({token:b,factory:b.ɵfac});var I=function(){function e(e,r,n,o){this.service=e,this.route=r,this.router=n,this.config=o,this.search="",this.gridQuery={tags:this.config.tag,type:"form"},this.refreshGrid=new t.EventEmitter,this.onSearch=c.debounce(this.onSearch,300)}return e.prototype.loadGrid=function(){var e=this;this.search=localStorage.getItem("searchInput"),this.gridQuery=JSON.parse(localStorage.getItem("query"))||this.gridQuery;var t=+localStorage.getItem("currentPage")||0;this.formGrid.refreshGrid(this.gridQuery).then((function(){return e.formGrid.setPage(t-1)}))},e.prototype.ngOnInit=function(){var e=this;this.gridQuery={tags:this.config.tag,type:"form"},this.service.reset(),this.service.ready.then((function(){e.loadGrid(),e.formGrid.footer.pageChanged.subscribe((function(e){localStorage.setItem("currentPage",e.page)}))}))},e.prototype.onSearch=function(){var e=this.search;e.length>0?(this.gridQuery.skip=0,this.gridQuery.title__regex="/"+e+"/i"):delete this.gridQuery.title__regex,localStorage.setItem("query",JSON.stringify(this.gridQuery)),localStorage.setItem("searchInput",this.search),this.formGrid.pageChanged({page:1,itemPerPage:this.gridQuery.limit}),this.refreshGrid.emit(this.gridQuery)},e.prototype.clearSearch=function(){this.gridQuery={tags:this.config.tag,type:"form"},localStorage.removeItem("query"),localStorage.removeItem("searchInput"),localStorage.removeItem("currentPage"),this.search="",this.formGrid.pageChanged({page:1}),this.formGrid.query={},this.formGrid.refreshGrid({tags:this.config.tag,type:"form"})},e.prototype.onAction=function(e){this.router.navigate([e.row._id,e.action],{relativeTo:this.route})},e.prototype.onSelect=function(e){this.router.navigate([e._id,"view"],{relativeTo:this.route})},e.prototype.onCreateItem=function(){this.router.navigate(["create"],{relativeTo:this.route})},e}();I.ɵfac=function(e){return new(e||I)(t.ɵɵdirectiveInject(b),t.ɵɵdirectiveInject(l.ActivatedRoute),t.ɵɵdirectiveInject(l.Router),t.ɵɵdirectiveInject(y))},I.ɵcmp=t.ɵɵdefineComponent({type:I,selectors:[["ng-component"]],viewQuery:function(e,r){var n;(1&e&&t.ɵɵviewQuery(s.FormioGridComponent,!0),2&e)&&(t.ɵɵqueryRefresh(n=t.ɵɵloadQuery())&&(r.formGrid=n.first))},decls:2,vars:2,consts:[["class","input-group mb-3",4,"ngIf"],[3,"formio","gridType","query","refresh","isActionAllowed","rowAction","rowSelect","createItem",4,"ngIf"],[1,"input-group","mb-3"],["type","text","placeholder","Search Forms","aria-label","Search Forms","aria-describedby","button-search",1,"form-control",3,"ngModel","keyup","ngModelChange"],["class","form-clear input-group-addon",3,"click",4,"ngIf"],[1,"form-clear","input-group-addon",3,"click"],[1,"fa","fa-times"],[3,"formio","gridType","query","refresh","isActionAllowed","rowAction","rowSelect","createItem"]],template:function(e,r){1&e&&(t.ɵɵtemplate(0,w,3,2,"div",0),t.ɵɵtemplate(1,x,1,5,"formio-grid",1)),2&e&&(t.ɵɵproperty("ngIf",r.config.includeSearch),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.service.ready))},directives:[m.NgIf,u.DefaultValueAccessor,u.NgControlStatus,u.NgModel,s.FormioGridComponent],styles:[".form-clear[_ngcontent-%COMP%]{align-items:center;background:#cecece;border-radius:50%;bottom:8px;color:rgba(0,0,0,.3);cursor:pointer;display:flex;height:24px;justify-content:center;position:absolute;right:10px;top:6px;width:24px;z-index:10}.form-clear[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{font-size:16px;font-weight:500}"]});
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var C=function(e,t){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};Object.create;Object.create;var E=["title"],A=["type"];function k(e,r){1&e&&t.ɵɵelement(0,"div",15)}function F(e,r){if(1&e&&t.ɵɵelement(0,"form-builder",16,17),2&e){var n=t.ɵɵnextContext();t.ɵɵproperty("formbuilder",n.config.builder)("form",n.form)}}var j=function(){function e(e,t,r,n,o,i){this.service=e,this.router=t,this.route=r,this.config=n,this.ref=o,this.alerts=i,this.form={components:[]},this.formReady=!1,this.loading=!1,this.editMode=!1}return e.prototype.initBuilder=function(e){var t=this;return e?(this.loading=!0,this.editMode=!0,this.service.loadForm().then((function(e){return t.form=e,t.formTitle.nativeElement.value=e.title,t.formType.nativeElement.value=e.display||"form",t.loading=!1,t.formReady=!0,t.ref.detectChanges(),!0})).catch((function(e){t.alerts.setAlert({type:"danger",message:e.message||e}),t.loading=!1,t.formReady=!0}))):(this.formReady=!0,Promise.resolve(!0))},e.prototype.ngAfterViewInit=function(){var e=this;this.route.url.subscribe((function(t){e.initBuilder("edit"===t[0].path)}))},e.prototype.onDisplaySelect=function(e){this.builder.setDisplay(e.target.value)},e.prototype.saveForm=function(){var e=this;return this.loading=!0,this.form.title=this.formTitle.nativeElement.value,this.form.display=this.formType.nativeElement.value,this.form.components=this.builder.formio.schema.components,this.config.tag&&(this.form.tags=this.form.tags||[],this.form.tags.push(this.config.tag),this.form.tags=g.default.uniq(this.form.tags)),this.form._id||(this.form.name=g.default.camelCase(this.form.title).toLowerCase(),this.form.path=this.form.name),this.service.formio.saveForm(this.form).then((function(t){return e.form=e.service.setForm(t),e.loading=!1,e.form})).catch((function(t){if(e.loading=!1,t._id&&t.type)throw t;e.alerts.setAlert({type:"danger",message:t.message||t})}))},e.prototype.onSave=function(){var e=this;return this.saveForm().then((function(t){e.editMode?e.router.navigate(["../","view"],{relativeTo:e.route}):e.router.navigate(["../",t._id,"view"],{relativeTo:e.route})}))},e}();function M(e,r){1&e&&t.ɵɵelement(0,"div",15)}function _(e,r){if(1&e&&t.ɵɵelement(0,"form-builder",16,17),2&e){var n=t.ɵɵnextContext();t.ɵɵproperty("formbuilder",n.config.builder)("form",n.form)}}j.ɵfac=function(e){return new(e||j)(t.ɵɵdirectiveInject(b),t.ɵɵdirectiveInject(l.Router),t.ɵɵdirectiveInject(l.ActivatedRoute),t.ɵɵdirectiveInject(y),t.ɵɵdirectiveInject(t.ChangeDetectorRef),t.ɵɵdirectiveInject(i.FormioAlerts))},j.ɵcmp=t.ɵɵdefineComponent({type:j,selectors:[["ng-component"]],viewQuery:function(e,r){var n;(1&e&&(t.ɵɵviewQuery(i.FormBuilderComponent,!0),t.ɵɵviewQuery(E,!0),t.ɵɵviewQuery(A,!0)),2&e)&&(t.ɵɵqueryRefresh(n=t.ɵɵloadQuery())&&(r.builder=n.first),t.ɵɵqueryRefresh(n=t.ɵɵloadQuery())&&(r.formTitle=n.first),t.ɵɵqueryRefresh(n=t.ɵɵloadQuery())&&(r.formType=n.first))},decls:21,vars:3,consts:[["class","loader",4,"ngIf"],[1,"form-group","row"],[1,"col-sm-8"],["type","text","id","formTitle","placeholder","Enter a Title",1,"form-control"],["title",""],[1,"col-sm-2"],["id","formSelect",1,"form-control",3,"change"],["type",""],["value","form"],["value","wizard"],["value","pdf"],[1,"btn","btn-primary","btn-block",3,"click"],[3,"alerts"],[3,"formbuilder","form",4,"ngIf"],[1,"btn","btn-primary",2,"margin-top","10px",3,"click"],[1,"loader"],[3,"formbuilder","form"],["builder",""]],template:function(e,r){1&e&&(t.ɵɵtemplate(0,k,1,0,"div",0),t.ɵɵelementStart(1,"div",1),t.ɵɵelementStart(2,"div",2),t.ɵɵelement(3,"input",3,4),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"div",5),t.ɵɵelementStart(6,"select",6,7),t.ɵɵlistener("change",(function(e){return r.onDisplaySelect(e)})),t.ɵɵelementStart(8,"option",8),t.ɵɵtext(9,"Form"),t.ɵɵelementEnd(),t.ɵɵelementStart(10,"option",9),t.ɵɵtext(11,"Wizard"),t.ɵɵelementEnd(),t.ɵɵelementStart(12,"option",10),t.ɵɵtext(13,"PDF"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(14,"div",5),t.ɵɵelementStart(15,"button",11),t.ɵɵlistener("click",(function(){return r.onSave()})),t.ɵɵtext(16,"Save Form"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelement(17,"formio-alerts",12),t.ɵɵtemplate(18,F,2,2,"form-builder",13),t.ɵɵelementStart(19,"button",14),t.ɵɵlistener("click",(function(){return r.onSave()})),t.ɵɵtext(20,"Save Form"),t.ɵɵelementEnd()),2&e&&(t.ɵɵproperty("ngIf",r.loading),t.ɵɵadvance(17),t.ɵɵproperty("alerts",r.alerts),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.formReady))},directives:[m.NgIf,u.NgSelectOption,u.ɵangular_packages_forms_forms_x,i.FormioAlertsComponent,i.FormBuilderComponent],encapsulation:2});var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return function(e,t){function r(){this.constructor=e}C(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.ngOnInit=function(){this.service.reset()},t}(j);R.ɵfac=function(e){return L(e||R)},R.ɵcmp=t.ɵɵdefineComponent({type:R,selectors:[["ng-component"]],features:[t.ɵɵInheritDefinitionFeature],decls:21,vars:3,consts:[["class","loader",4,"ngIf"],[1,"form-group","row"],[1,"col-sm-8"],["type","text","id","formTitle","placeholder","Enter a Title",1,"form-control"],["title",""],[1,"col-sm-2"],["id","formSelect",1,"form-control",3,"change"],["type",""],["value","form"],["value","wizard"],["value","pdf"],[1,"btn","btn-primary","btn-block",3,"click"],[3,"alerts"],[3,"formbuilder","form",4,"ngIf"],[1,"btn","btn-primary",2,"margin-top","10px",3,"click"],[1,"loader"],[3,"formbuilder","form"],["builder",""]],template:function(e,r){1&e&&(t.ɵɵtemplate(0,M,1,0,"div",0),t.ɵɵelementStart(1,"div",1),t.ɵɵelementStart(2,"div",2),t.ɵɵelement(3,"input",3,4),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"div",5),t.ɵɵelementStart(6,"select",6,7),t.ɵɵlistener("change",(function(e){return r.onDisplaySelect(e)})),t.ɵɵelementStart(8,"option",8),t.ɵɵtext(9,"Form"),t.ɵɵelementEnd(),t.ɵɵelementStart(10,"option",9),t.ɵɵtext(11,"Wizard"),t.ɵɵelementEnd(),t.ɵɵelementStart(12,"option",10),t.ɵɵtext(13,"PDF"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(14,"div",5),t.ɵɵelementStart(15,"button",11),t.ɵɵlistener("click",(function(){return r.onSave()})),t.ɵɵtext(16,"Save Form"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelement(17,"formio-alerts",12),t.ɵɵtemplate(18,_,2,2,"form-builder",13),t.ɵɵelementStart(19,"button",14),t.ɵɵlistener("click",(function(){return r.onSave()})),t.ɵɵtext(20,"Save Form"),t.ɵɵelementEnd()),2&e&&(t.ɵɵproperty("ngIf",r.loading),t.ɵɵadvance(17),t.ɵɵproperty("alerts",r.alerts),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.formReady))},directives:[m.NgIf,u.NgSelectOption,u.ɵangular_packages_forms_forms_x,i.FormioAlertsComponent,i.FormBuilderComponent],encapsulation:2});var L=t.ɵɵgetInheritedFactory(R);function D(e,r){if(1&e){var n=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",12),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(n);var e=t.ɵɵnextContext(),r=t.ɵɵreference(17);return e.openEmbed(r)})),t.ɵɵelement(1,"i",13),t.ɵɵtext(2," Share"),t.ɵɵelementEnd()}}function O(e,r){1&e&&(t.ɵɵelementStart(0,"li",5),t.ɵɵelementStart(1,"a",14),t.ɵɵelement(2,"i",15),t.ɵɵtext(3," Edit Form"),t.ɵɵelementEnd(),t.ɵɵelementEnd())}function T(e,r){1&e&&(t.ɵɵelementStart(0,"li",5),t.ɵɵelementStart(1,"a",16),t.ɵɵelement(2,"span",17),t.ɵɵelementEnd(),t.ɵɵelementEnd())}function V(e,r){if(1&e&&(t.ɵɵelementStart(0,"pre"),t.ɵɵelement(1,"textarea",31),t.ɵɵelementEnd()),2&e){var n=t.ɵɵnextContext(2);t.ɵɵadvance(1),t.ɵɵproperty("ngModel",n.embedCode)}}function U(e,r){if(1&e&&t.ɵɵelement(0,"input",32),2&e){var n=t.ɵɵnextContext(2);t.ɵɵproperty("ngModel",n.shareUrl)}}var q=function(e){return{active:e}};function Q(e,r){if(1&e){var n=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",18),t.ɵɵelementStart(1,"h4",19),t.ɵɵtext(2,"Share or Embed this form"),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"button",20),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(n),t.ɵɵnextContext().modalRef.hide()})),t.ɵɵelementStart(4,"span",21),t.ɵɵtext(5,"×"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"div",22),t.ɵɵelementStart(7,"ul",23),t.ɵɵelementStart(8,"li",2),t.ɵɵelementStart(9,"a",24),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(n),t.ɵɵnextContext().choices("isUrl")})),t.ɵɵelement(10,"i",25),t.ɵɵtext(11," URL"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(12,"li",2),t.ɵɵelementStart(13,"a",24),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(n),t.ɵɵnextContext().choices("isEmbed")})),t.ɵɵelement(14,"i",26),t.ɵɵtext(15," Embed"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵtemplate(16,V,2,1,"pre",27),t.ɵɵtemplate(17,U,1,1,"input",28),t.ɵɵelementEnd(),t.ɵɵelementStart(18,"div",29),t.ɵɵelementStart(19,"button",30),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(n),t.ɵɵnextContext().modalRef.hide()})),t.ɵɵtext(20,"Close"),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext();t.ɵɵadvance(9),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(4,q,"isUrl"===o.choice)),t.ɵɵadvance(4),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(6,q,"isEmbed"===o.choice)),t.ɵɵadvance(3),t.ɵɵproperty("ngIf","isEmbed"===o.choice),t.ɵɵadvance(1),t.ɵɵproperty("ngIf","isUrl"===o.choice)}}var N=function(){function e(e,t,r,n,o){this.service=e,this.route=t,this.appConfig=r,this.options=n,this.modalService=o,this.choice="isUrl",this.goTo=""}return e.prototype.ngOnInit=function(){var e=this;this.route.params.subscribe((function(t){e.formio=new r.Formio(e.appConfig.appUrl+"/form/"+t.id),e.formio.loadForm().then((function(t){e.projectId=t.project,e.pathName=t.path,e.getShareUrl()})),e.service.reset(e.route)}))},e.prototype.getShareUrl=function(){var e=this.appConfig.appUrl+"/"+this.pathName;return this.shareUrl=this.options.viewer+"/#/?src="+encodeURIComponent(e),this.shareUrl},e.prototype.openEmbed=function(e){var t="";this.goTo&&(t+='if (d && d.formSubmission && d.formSubmission._id) { window.location.href = "'+this.goTo+'";}');var r='<script type="text/javascript">';r+="(function a(d, w, u) {",r+='var h = d.getElementsByTagName("head")[0];',r+='var s = d.createElement("script");',r+='s.type = "text/javascript";',r+='s.src = "'+this.options.viewer+'/assets/lib/seamless/seamless.parent.min.js";',r+="s.onload = function b() {",r+='var f = d.getElementById("formio-form-'+this.formio.formId+'");',r+="if (!f || (typeof w.seamless === u)) {",r+="return setTimeout(b, 100);",r+="}",r+="w.seamless(f, {fallback:false}).receive(function(d, e) {"+t+"});",r+="};",r+="h.appendChild(s);",r+="})(document, window);",r+="<\/script>",r+='<iframe id="formio-form-'+this.formio.formId+'" ',r+='style="width:100%;border:none;" height="800px" src="'+this.shareUrl+'&iframe=1"></iframe>',this.embedCode=r,this.modalRef=this.modalService.show(e,{class:"modal-lg"})},e.prototype.choices=function(e){this.choice=e},e}();function P(e,r){if(1&e){var n=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"formio",1),t.ɵɵlistener("submit",(function(e){return t.ɵɵrestoreView(n),t.ɵɵnextContext().onSubmit(e)})),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext();t.ɵɵproperty("renderer",o.config.renderer)("renderOptions",o.renderOptions)("url",o.service.formio.formUrl)("form",o.currentForm)("submission",o.submission)("success",o.onSuccess)("error",o.onError)}}N.ɵfac=function(e){return new(e||N)(t.ɵɵdirectiveInject(b),t.ɵɵdirectiveInject(l.ActivatedRoute),t.ɵɵdirectiveInject(i.FormioAppConfig),t.ɵɵdirectiveInject(y),t.ɵɵdirectiveInject(f.BsModalService))},N.ɵcmp=t.ɵɵdefineComponent({type:N,selectors:[["ng-component"]],decls:18,vars:3,consts:[["class","pull-right btn btn-outline-primary",3,"click",4,"ngIf"],[1,"nav","nav-tabs","mb-2"],[1,"nav-item"],["routerLink","../",1,"nav-link"],[1,"fa","fa-chevron-left","glyphicon","glyphicon-chevron-left"],["routerLinkActive","active",1,"nav-item"],["routerLink","view","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-pencil","glyphicon","glyphicon-pencil"],["routerLink","submission","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-list-alt","glyphicon","glyphicon-list-alt"],["class","nav-item","routerLinkActive","active",4,"ngIf"],["content",""],[1,"pull-right","btn","btn-outline-primary",3,"click"],[1,"fa","fa-share-alt","glyphicon","glyphicon-share"],["routerLink","edit","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-edit","glyphicon","glyphicon-edit"],["routerLink","delete","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-trash","glyphicon","glyphicon-trash"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"nav","nav-tabs","mr-auto","mb-2"],[1,"nav-link",3,"ngClass","click"],[1,"fa","fa-link"],[1,"fa","fa-code"],[4,"ngIf"],["type","text","onclick","this.focus();this.select()","readonly","readonly","class","form-control","placeholder","https://examples.form.io/example",3,"ngModel",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["onclick","this.focus();this.select()","readonly","readonly","rows","8",2,"width","100%",3,"ngModel"],["type","text","onclick","this.focus();this.select()","readonly","readonly","placeholder","https://examples.form.io/example",1,"form-control",3,"ngModel"]],template:function(e,r){1&e&&(t.ɵɵtemplate(0,D,3,0,"button",0),t.ɵɵelementStart(1,"ul",1),t.ɵɵelementStart(2,"li",2),t.ɵɵelementStart(3,"a",3),t.ɵɵelement(4,"i",4),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"li",5),t.ɵɵelementStart(6,"a",6),t.ɵɵelement(7,"i",7),t.ɵɵtext(8," Enter Data"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(9,"li",5),t.ɵɵelementStart(10,"a",8),t.ɵɵelement(11,"i",9),t.ɵɵtext(12," View Data"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵtemplate(13,O,4,0,"li",10),t.ɵɵtemplate(14,T,3,0,"li",10),t.ɵɵelementEnd(),t.ɵɵelement(15,"router-outlet"),t.ɵɵtemplate(16,Q,21,8,"ng-template",null,11,t.ɵɵtemplateRefExtractor)),2&e&&(t.ɵɵproperty("ngIf",r.options.viewer),t.ɵɵadvance(13),t.ɵɵproperty("ngIf",r.service.actionAllowed("formEdit")),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.service.actionAllowed("formDelete")))},directives:[m.NgIf,l.RouterLinkWithHref,l.RouterLinkActive,l.RouterOutlet,m.NgClass,u.DefaultValueAccessor,u.NgControlStatus,u.NgModel],encapsulation:2});var G=function(){function e(e,r,n,o,i){this.service=e,this.router=r,this.route=n,this.config=o,this.auth=i,this.onSuccess=new t.EventEmitter,this.onError=new t.EventEmitter,this.renderOptions={saveDraft:this.config.saveDraft},this.currentForm=null,this.submission={data:{}}}return e.prototype.ngOnInit=function(){var e=this;this.service.formio=new r.Formio(this.service.formio.formUrl),this.service.loadForm().then((function(t){e.currentForm=t}))},e.prototype.onSubmit=function(e){var t=this;this.submission.data=e.data,this.submission.state="complete",this.service.formio.saveSubmission(this.submission).then((function(e){t.onSuccess.emit(),t.router.navigate(["../","submission",e._id],{relativeTo:t.route})})).catch((function(e){return t.onError.emit(e)}))},e}();G.ɵfac=function(e){return new(e||G)(t.ɵɵdirectiveInject(b),t.ɵɵdirectiveInject(l.Router),t.ɵɵdirectiveInject(l.ActivatedRoute),t.ɵɵdirectiveInject(y),t.ɵɵdirectiveInject(a.FormioAuthService))},G.ɵcmp=t.ɵɵdefineComponent({type:G,selectors:[["ng-component"]],decls:1,vars:1,consts:[[3,"renderer","renderOptions","url","form","submission","success","error","submit",4,"ngIf"],[3,"renderer","renderOptions","url","form","submission","success","error","submit"]],template:function(e,r){1&e&&t.ɵɵtemplate(0,P,1,7,"formio",0),2&e&&t.ɵɵproperty("ngIf",r.currentForm)},directives:[m.NgIf,i.FormioComponent],encapsulation:2});var B=function(){function e(e,t,r,n){this.service=e,this.router=t,this.route=r,this.alerts=n}return e.prototype.onDelete=function(){var e=this;this.service.formio.deleteForm().then((function(){e.router.navigate(["../../"],{relativeTo:e.route})})).catch((function(t){return e.alerts.setAlert({type:"danger",message:t.message||t})}))},e.prototype.onCancel=function(){this.router.navigate(["../","view"],{relativeTo:this.route})},e}();B.ɵfac=function(e){return new(e||B)(t.ɵɵdirectiveInject(b),t.ɵɵdirectiveInject(l.Router),t.ɵɵdirectiveInject(l.ActivatedRoute),t.ɵɵdirectiveInject(i.FormioAlerts))},B.ɵcmp=t.ɵɵdefineComponent({type:B,selectors:[["ng-component"]],decls:8,vars:1,consts:[[3,"alerts"],[1,"btn-toolbar"],["type","button",1,"btn","btn-danger",2,"margin-right","10px",3,"click"],["type","button",1,"btn","btn-default",3,"click"]],template:function(e,r){1&e&&(t.ɵɵelement(0,"formio-alerts",0),t.ɵɵelementStart(1,"h3"),t.ɵɵtext(2,"Are you sure you wish to delete this form?"),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"div",1),t.ɵɵelementStart(4,"button",2),t.ɵɵlistener("click",(function(){return r.onDelete()})),t.ɵɵtext(5,"Yes"),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"button",3),t.ɵɵlistener("click",(function(){return r.onCancel()})),t.ɵɵtext(7,"No"),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&t.ɵɵproperty("alerts",r.alerts)},directives:[i.FormioAlertsComponent],encapsulation:2});var z=function(){function e(e,t,r){this.service=e,this.router=t,this.route=r}return e.prototype.onSubmit=function(e){this.router.navigate(["../../"],{relativeTo:this.route})},e}();z.ɵfac=function(e){return new(e||z)(t.ɵɵdirectiveInject(b),t.ɵɵdirectiveInject(l.Router),t.ɵɵdirectiveInject(l.ActivatedRoute))},z.ɵcmp=t.ɵɵdefineComponent({type:z,selectors:[["ng-component"]],decls:1,vars:2,consts:[[3,"renderer","src","submit","formLoad","submissionLoad"]],template:function(e,r){1&e&&(t.ɵɵelementStart(0,"formio",0),t.ɵɵlistener("submit",(function(e){return r.onSubmit(e)}))("formLoad",(function(e){return r.service.setForm(e)}))("submissionLoad",(function(e){return r.service.submissionLoaded(e)})),t.ɵɵelementEnd()),2&e&&t.ɵɵproperty("renderer",r.service.config.renderer)("src",r.service.formio.submissionUrl)},directives:[i.FormioComponent],encapsulation:2});var J=function(){function e(e,t,r,n){this.service=e,this.router=t,this.route=r,this.alerts=n}return e.prototype.onDelete=function(){var e=this;this.service.formio.deleteSubmission().then((function(){e.router.navigate(["../../"],{relativeTo:e.route})})).catch((function(t){return e.alerts.setAlert({type:"danger",message:t.message||t})}))},e.prototype.onCancel=function(){this.router.navigate(["../","view"],{relativeTo:this.route})},e}();J.ɵfac=function(e){return new(e||J)(t.ɵɵdirectiveInject(b),t.ɵɵdirectiveInject(l.Router),t.ɵɵdirectiveInject(l.ActivatedRoute),t.ɵɵdirectiveInject(i.FormioAlerts))},J.ɵcmp=t.ɵɵdefineComponent({type:J,selectors:[["ng-component"]],decls:8,vars:1,consts:[[3,"alerts"],[1,"btn-toolbar"],["type","button",1,"btn","btn-danger",2,"margin-right","10px",3,"click"],["type","button",1,"btn","btn-default",3,"click"]],template:function(e,r){1&e&&(t.ɵɵelement(0,"formio-alerts",0),t.ɵɵelementStart(1,"h3"),t.ɵɵtext(2,"Are you sure you wish to delete this record?"),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"div",1),t.ɵɵelementStart(4,"button",2),t.ɵɵlistener("click",(function(){return r.onDelete()})),t.ɵɵtext(5,"Yes"),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"button",3),t.ɵɵlistener("click",(function(){return r.onCancel()})),t.ɵɵtext(7,"No"),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&t.ɵɵproperty("alerts",r.alerts)},directives:[i.FormioAlertsComponent],encapsulation:2});var W=function(e){this.service=e};W.ɵfac=function(e){return new(e||W)(t.ɵɵdirectiveInject(b))},W.ɵcmp=t.ɵɵdefineComponent({type:W,selectors:[["ng-component"]],decls:1,vars:3,consts:[[3,"renderer","src","readOnly","formLoad","submissionLoad"]],template:function(e,r){1&e&&(t.ɵɵelementStart(0,"formio",0),t.ɵɵlistener("formLoad",(function(e){return r.service.setForm(e)}))("submissionLoad",(function(e){return r.service.submissionLoaded(e)})),t.ɵɵelementEnd()),2&e&&t.ɵɵproperty("renderer",r.service.config.renderer)("src",r.service.formio.submissionUrl)("readOnly",!0)},directives:[i.FormioComponent],encapsulation:2});var Y=function(){function e(e,t,r){this.service=e,this.route=t,this.router=r}return e.prototype.onSelect=function(e){this.router.navigate([e._id,"view"],{relativeTo:this.route})},e}();function H(e,r){if(1&e&&(t.ɵɵelementStart(0,"a",9),t.ɵɵelement(1,"img",10),t.ɵɵelementEnd()),2&e){var n=t.ɵɵnextContext();t.ɵɵproperty("href",n.downloadUrl,t.ɵɵsanitizeUrl)}}function K(e,r){1&e&&(t.ɵɵelementStart(0,"li",5),t.ɵɵelementStart(1,"a",11),t.ɵɵelement(2,"i",12),t.ɵɵtext(3," Edit"),t.ɵɵelementEnd(),t.ɵɵelementEnd())}function X(e,r){1&e&&(t.ɵɵelementStart(0,"li",5),t.ɵɵelementStart(1,"a",13),t.ɵɵelement(2,"span",14),t.ɵɵelementEnd(),t.ɵɵelementEnd())}Y.ɵfac=function(e){return new(e||Y)(t.ɵɵdirectiveInject(b),t.ɵɵdirectiveInject(l.ActivatedRoute),t.ɵɵdirectiveInject(l.Router))},Y.ɵcmp=t.ɵɵdefineComponent({type:Y,selectors:[["ng-component"]],decls:1,vars:1,consts:[[3,"formio","rowSelect"]],template:function(e,r){1&e&&(t.ɵɵelementStart(0,"formio-grid",0),t.ɵɵlistener("rowSelect",(function(e){return r.onSelect(e)})),t.ɵɵelementEnd()),2&e&&t.ɵɵproperty("formio",r.service.formio)},directives:[s.FormioGridComponent],encapsulation:2});var Z=function(){function e(e,t){this.service=e,this.route=t}return e.prototype.setDownloadUrl=function(e){this.downloadUrl=e},e.prototype.ngOnInit=function(){var e=this;this.service.setSubmission(this.route).then((function(t){t.getDownloadUrl().then((function(t){return e.setDownloadUrl(t)}))}))},e}();function $(e){return[{path:"",component:e&&e.formIndex?e.formIndex:I},{path:"create",component:e&&e.formCreate?e.formCreate:R},{path:":id",component:e&&e.form?e.form:N,children:[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:e&&e.formView?e.formView:G},{path:"edit",component:e&&e.formEdit?e.formEdit:j},{path:"delete",component:e&&e.formDelete?e.formDelete:B},{path:"submission",component:e&&e.submissionIndex?e.submissionIndex:Y},{path:"submission/:id",component:e&&e.submission?e.submission:Z,children:[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:e&&e.submissionView?e.submissionView:W},{path:"edit",component:e&&e.submissionEdit?e.submissionEdit:z},{path:"delete",component:e&&e.submissionDelete?e.submissionDelete:J}]}]}]}Z.ɵfac=function(e){return new(e||Z)(t.ɵɵdirectiveInject(b),t.ɵɵdirectiveInject(l.ActivatedRoute))},Z.ɵcmp=t.ɵɵdefineComponent({type:Z,selectors:[["ng-component"]],decls:12,vars:3,consts:[["target","_blank","class","pull-right",3,"href",4,"ngIf"],[1,"nav","nav-tabs",2,"margin-bottom","10px"],[1,"nav-item"],["routerLink","../",1,"nav-link"],[1,"fa","fa-chevron-left","glyphicon","glyphicon-chevron-left"],["routerLinkActive","active",1,"nav-item"],["routerLink","view","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-eye","glyphicon","glyphicon-eye"],["class","nav-item","routerLinkActive","active",4,"ngIf"],["target","_blank",1,"pull-right",3,"href"],["src","https://pro.formview.io/assets/pdf.png",2,"height","2em"],["routerLink","edit","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-edit","glyphicon","glyphicon-edit"],["routerLink","delete","routerLinkActive","active",1,"nav-link"],[1,"fa","fa-trash","glyphicon","glyphicon-trash"]],template:function(e,r){1&e&&(t.ɵɵtemplate(0,H,2,1,"a",0),t.ɵɵelementStart(1,"ul",1),t.ɵɵelementStart(2,"li",2),t.ɵɵelementStart(3,"a",3),t.ɵɵelement(4,"i",4),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"li",5),t.ɵɵelementStart(6,"a",6),t.ɵɵelement(7,"i",7),t.ɵɵtext(8," View"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵtemplate(9,K,4,0,"li",8),t.ɵɵtemplate(10,X,3,0,"li",8),t.ɵɵelementEnd(),t.ɵɵelement(11,"router-outlet")),2&e&&(t.ɵɵproperty("ngIf",r.downloadUrl),t.ɵɵadvance(9),t.ɵɵproperty("ngIf",r.service.perms.edit),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.service.perms.delete))},directives:[m.NgIf,l.RouterLinkWithHref,l.RouterLinkActive,l.RouterOutlet],encapsulation:2});var ee=function(){function e(){}return e.forChild=function(t){return i.extendRouter(e,t,$)},e.forRoot=function(t){return i.extendRouter(e,t,$)},e}();ee.ɵmod=t.ɵɵdefineNgModule({type:ee}),ee.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||ee)},imports:[[m.CommonModule,i.FormioModule,l.RouterModule,u.FormsModule,s.FormioGrid,f.ModalModule.forRoot(),d.PaginationModule.forRoot()]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(ee,{declarations:[I,R,N,G,j,B,Z,z,J,W,Y],imports:[m.CommonModule,i.FormioModule,l.RouterModule,u.FormsModule,s.FormioGrid,f.ModalModule,d.PaginationModule]}),e.FormManagerConfig=y,e.FormManagerCreateComponent=R,e.FormManagerDeleteComponent=B,e.FormManagerEditComponent=j,e.FormManagerFormComponent=N,e.FormManagerIndexComponent=I,e.FormManagerModule=ee,e.FormManagerRoutes=$,e.FormManagerService=b,e.FormManagerViewComponent=G,e.SubmissionComponent=Z,e.SubmissionDeleteComponent=J,e.SubmissionEditComponent=z,e.SubmissionIndexComponent=Y,e.SubmissionViewComponent=W,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-formio-manager.umd.min.js.map