!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/forms"),require("@angular/router"),require("angular-formio"),require("lodash"),require("formiojs"),require("ngx-bootstrap/pagination")):"function"==typeof define&&define.amd?define("angular-formio/grid",["exports","@angular/core","@angular/common","@angular/forms","@angular/router","angular-formio","lodash","formiojs","ngx-bootstrap/pagination"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["angular-formio"]=e["angular-formio"]||{},e["angular-formio"].grid={}),e.ng.core,e.ng.common,e.ng.forms,e.ng.router,e["angular-formio"],e._,e.formiojs,e["ngx-bootstrap/pagination"])}(this,(function(e,t,n,o,r,i,a,s,l){"use strict";var c;!function(e){e[e.bottom=0]="bottom",e[e.top=1]="top",e[e.both=2]="both"}(c||(c={}));
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function m(e,t){function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.create;Object.create;var f,u=function(){function e(){this.headers=[],this.sort=new t.EventEmitter}return Object.defineProperty(e.prototype,"numHeaders",{get:function(){return this.headers.length},enumerable:!1,configurable:!0}),e.prototype.load=function(e,t,n){return Promise.resolve([])},e}();u.ɵfac=function(e){return new(e||u)},u.ɵcmp=t.ɵɵdefineComponent({type:u,selectors:[["ng-component"]],viewQuery:function(e,n){var o;(1&e&&t.ɵɵstaticViewQuery(t.TemplateRef,!0),2&e)&&(t.ɵɵqueryRefresh(o=t.ɵɵloadQuery())&&(n.template=o.first))},inputs:{actionAllowed:"actionAllowed"},outputs:{sort:"sort"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),function(e){e.ASC="asc",e.DESC="desc"}(f||(f={}));var d=function(e,t){return{"glyphicon-triangle-top fa-caret-up":e,"glyphicon-triangle-bottom fa-caret-down":t}};function h(e,n){if(1&e&&t.ɵɵelement(0,"span",5),2&e){var o=t.ɵɵnextContext(2);t.ɵɵproperty("ngClass",t.ɵɵpureFunction2(1,d,"asc"===o.header.sort,"desc"===o.header.sort))}}function g(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"thead"),t.ɵɵelementStart(1,"tr"),t.ɵɵelementStart(2,"th"),t.ɵɵelementStart(3,"div",0),t.ɵɵelementStart(4,"div",1),t.ɵɵelementStart(5,"a",2),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(o);var e=t.ɵɵnextContext();return e.sort.emit(e.header)})),t.ɵɵtext(6),t.ɵɵtemplate(7,h,1,4,"span",3),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(8,"div",4),t.ɵɵtext(9," Operations "),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var r=t.ɵɵnextContext();t.ɵɵadvance(6),t.ɵɵtextInterpolate1(" ",r.header.label," "),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.header.sort)}}var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.load=function(e){return this.header={label:"Title",key:"title",sort:f.ASC},this.headers=[this.header],Promise.resolve(this.headers)},Object.defineProperty(t.prototype,"numHeaders",{get:function(){return 2},enumerable:!1,configurable:!0}),t}(u);y.ɵfac=function(e){return v(e||y)},y.ɵcmp=t.ɵɵdefineComponent({type:y,selectors:[["form-grid-header"]],features:[t.ɵɵInheritDefinitionFeature],decls:1,vars:0,consts:[[1,"row"],[1,"col-sm-8"],[3,"click"],["class","glyphicon fa",3,"ngClass",4,"ngIf"],[1,"col-sm-4"],[1,"glyphicon","fa",3,"ngClass"]],template:function(e,n){1&e&&t.ɵɵtemplate(0,g,10,2,"ng-template")},directives:[n.NgIf,n.NgClass],encapsulation:2});var v=t.ɵɵgetInheritedFactory(y),C=function(){function e(){this.firstItem=0,this.lastItem=0,this.skip=0,this.limit=0,this.total=0,this.rowSelect=new t.EventEmitter,this.rowAction=new t.EventEmitter,this.loading=!0}return e.prototype.load=function(e,t){return e.loadForm(t)},e.prototype.onRowSelect=function(e,t){e.preventDefault(),this.rowSelect.emit(t)},e.prototype.onRowAction=function(e,t,n){e.preventDefault(),this.rowAction.emit({row:t,action:n})},e.prototype.setRows=function(e,t){var n=this;return this.rows=[],"object"!=typeof t?(this.firstItem=0,this.lastItem=0,this.total=0,this.skip=0,this.loading=!1,this.rows):(this.firstItem=e.skip+1,this.lastItem=this.firstItem+t.length-1,this.total=t.serverCount,this.limit=e.limit,this.skip=Math.floor(t.skip/e.limit)+1,this.loading=!1,a.each(t,(function(e){n.rows.push(a.clone(e))})),this.rows)},e}();function x(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",7),t.ɵɵlistener("click",(function(e){t.ɵɵrestoreView(o);var n=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext(3).onRowAction(e,n,"view")})),t.ɵɵelement(1,"span",8),t.ɵɵtext(2," Enter Data"),t.ɵɵelementEnd()}}function w(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",7),t.ɵɵlistener("click",(function(e){t.ɵɵrestoreView(o);var n=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext(3).onRowAction(e,n,"submission")})),t.ɵɵelement(1,"span",9),t.ɵɵtext(2," View Data"),t.ɵɵelementEnd()}}function b(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",7),t.ɵɵlistener("click",(function(e){t.ɵɵrestoreView(o);var n=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext(3).onRowAction(e,n,"edit")})),t.ɵɵelement(1,"span",10),t.ɵɵtext(2," Edit Form"),t.ɵɵelementEnd()}}function I(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",7),t.ɵɵlistener("click",(function(e){t.ɵɵrestoreView(o);var n=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext(3).onRowAction(e,n,"delete")})),t.ɵɵelement(1,"span",11),t.ɵɵelementEnd()}}function E(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"tr"),t.ɵɵelementStart(1,"td"),t.ɵɵelementStart(2,"div",2),t.ɵɵelementStart(3,"div",3),t.ɵɵelementStart(4,"a",4),t.ɵɵlistener("click",(function(e){t.ɵɵrestoreView(o);var r=n.$implicit;return t.ɵɵnextContext(3).onRowSelect(e,r)})),t.ɵɵelementStart(5,"h5"),t.ɵɵtext(6),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(7,"div",5),t.ɵɵtemplate(8,x,3,0,"button",6),t.ɵɵtext(9,"  "),t.ɵɵtemplate(10,w,3,0,"button",6),t.ɵɵtext(11,"  "),t.ɵɵtemplate(12,b,3,0,"button",6),t.ɵɵtext(13,"  "),t.ɵɵtemplate(14,I,2,0,"button",6),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var r=n.$implicit,i=t.ɵɵnextContext(3);t.ɵɵadvance(4),t.ɵɵpropertyInterpolate1("routerLink","",r._id,"/view"),t.ɵɵadvance(2),t.ɵɵtextInterpolate(r.title),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",i.actionAllowed("formView")),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",i.actionAllowed("submissionIndex")),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",i.actionAllowed("formEdit")),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",i.actionAllowed("formDelete"))}}function S(e,n){if(1&e&&(t.ɵɵelementStart(0,"tbody"),t.ɵɵtemplate(1,E,15,6,"tr",1),t.ɵɵelementEnd()),2&e){var o=t.ɵɵnextContext(2);t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",o.rows)}}function F(e,n){if(1&e&&t.ɵɵtemplate(0,S,2,1,"tbody",0),2&e){var o=t.ɵɵnextContext();t.ɵɵproperty("ngIf",o.rows)}}C.ɵfac=function(e){return new(e||C)},C.ɵcmp=t.ɵɵdefineComponent({type:C,selectors:[["ng-component"]],viewQuery:function(e,n){var o;(1&e&&t.ɵɵstaticViewQuery(t.TemplateRef,!0),2&e)&&(t.ɵɵqueryRefresh(o=t.ɵɵloadQuery())&&(n.template=o.first))},inputs:{header:"header",actionAllowed:"actionAllowed"},outputs:{rowSelect:"rowSelect",rowAction:"rowAction"},decls:0,vars:0,template:function(e,t){},encapsulation:2});var O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.load=function(e,t){var n=this;return t=t||{},e.loadForms({params:t}).then((function(e){return n.setRows(t,e)}))},t}(C);O.ɵfac=function(e){return T(e||O)},O.ɵcmp=t.ɵɵdefineComponent({type:O,selectors:[["form-grid-body"]],features:[t.ɵɵInheritDefinitionFeature],decls:1,vars:0,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"row"],[1,"col-sm-8"],[3,"routerLink","click"],[1,"col-sm-4"],["class","btn btn-secondary btn-sm form-btn",3,"click",4,"ngIf"],[1,"btn","btn-secondary","btn-sm","form-btn",3,"click"],[1,"fa","fa-pencil"],[1,"fa","fa-list-alt"],[1,"fa","fa-edit"],[1,"fa","fa-trash"]],template:function(e,n){1&e&&t.ɵɵtemplate(0,F,1,1,"ng-template")},directives:[n.NgIf,n.NgForOf,r.RouterLinkWithHref],styles:[".form-btn[_ngcontent-%COMP%]{font-size:.75rem}"]});var T=t.ɵɵgetInheritedFactory(O),A=function(){this.footerPositions=c,this.pageChanged=new t.EventEmitter,this.createItem=new t.EventEmitter};function P(e,n){if(1&e&&(t.ɵɵelementStart(0,"thead",3),t.ɵɵelementContainer(1,4),t.ɵɵelementEnd()),2&e){t.ɵɵnextContext(2);var o=t.ɵɵreference(3);t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",o)}}function k(e,n){if(1&e&&(t.ɵɵelementStart(0,"tfoot",3),t.ɵɵelementContainer(1,4),t.ɵɵelementEnd()),2&e){t.ɵɵnextContext(2);var o=t.ɵɵreference(3);t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",o)}}function V(e,n){if(1&e&&(t.ɵɵtemplate(0,P,2,1,"thead",2),t.ɵɵtemplate(1,k,2,1,"tfoot",2)),2&e){var o=n.position,r=t.ɵɵnextContext();t.ɵɵproperty("ngIf",o===r.footerPositions.top),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",o===r.footerPositions.bottom)}}function R(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",11),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(o),t.ɵɵnextContext(3).createItem.emit("form")})),t.ɵɵelement(1,"i",12),t.ɵɵtext(2),t.ɵɵelementEnd()}if(2&e){var r=t.ɵɵnextContext(3);t.ɵɵadvance(2),t.ɵɵtextInterpolate1(" ",r.createText,"")}}function q(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"td",6),t.ɵɵtemplate(1,R,3,1,"button",7),t.ɵɵelementStart(2,"span",8),t.ɵɵelementStart(3,"span",9),t.ɵɵtext(4),t.ɵɵelementEnd(),t.ɵɵtext(5),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"pagination",10),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(o),t.ɵɵnextContext(2).body.skip=e}))("pageChanged",(function(e){return t.ɵɵrestoreView(o),t.ɵɵnextContext(2).pageChanged.emit(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var r=t.ɵɵnextContext(2);t.ɵɵproperty("colSpan",r.header.numHeaders),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.actionAllowed("formCreate")),t.ɵɵadvance(3),t.ɵɵtextInterpolate2("",r.body.firstItem," - ",r.body.lastItem,""),t.ɵɵadvance(1),t.ɵɵtextInterpolate1(" / ",r.body.total," total"),t.ɵɵadvance(1),t.ɵɵproperty("totalItems",r.body.total)("itemsPerPage",r.body.limit)("ngModel",r.body.skip)("maxSize",r.size)}}function M(e,n){if(1&e&&(t.ɵɵelementStart(0,"tr"),t.ɵɵtemplate(1,q,7,9,"td",5),t.ɵɵelementEnd()),2&e){var o=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵproperty("ngIf",o.header)}}A.ɵfac=function(e){return new(e||A)},A.ɵcmp=t.ɵɵdefineComponent({type:A,selectors:[["ng-component"]],viewQuery:function(e,n){var o;(1&e&&t.ɵɵstaticViewQuery(t.TemplateRef,!0),2&e)&&(t.ɵɵqueryRefresh(o=t.ɵɵloadQuery())&&(n.template=o.first))},inputs:{header:"header",body:"body",createText:"createText",size:"size",actionAllowed:"actionAllowed"},outputs:{pageChanged:"pageChanged",createItem:"createItem"},decls:0,vars:0,template:function(e,t){},encapsulation:2});var z=function(e){function t(){return e.call(this)||this}return m(t,e),t.prototype.ngOnInit=function(){this.createText||(this.createText="Create Form"),this.size||(this.size=7)},t}(A);z.ɵfac=function(e){return new(e||z)},z.ɵcmp=t.ɵɵdefineComponent({type:z,selectors:[["ng-component"]],features:[t.ɵɵInheritDefinitionFeature],decls:4,vars:0,consts:[["footer",""],["defaultFooterTemplate",""],["class","formio-grid-footer",4,"ngIf"],[1,"formio-grid-footer"],[3,"ngTemplateOutlet"],[3,"colSpan",4,"ngIf"],[3,"colSpan"],["class","btn btn-primary pull-left float-left",3,"click",4,"ngIf"],[1,"pull-right","float-right","item-counter"],[1,"page-num"],[1,"justify-content-center","pagination-sm",3,"totalItems","itemsPerPage","ngModel","maxSize","ngModelChange","pageChanged"],[1,"btn","btn-primary","pull-left","float-left",3,"click"],[1,"glyphicon","glyphicon-plus","fa","fa-plus"]],template:function(e,n){1&e&&(t.ɵɵtemplate(0,V,2,2,"ng-template",null,0,t.ɵɵtemplateRefExtractor),t.ɵɵtemplate(2,M,2,1,"ng-template",null,1,t.ɵɵtemplateRefExtractor))},directives:[n.NgIf,n.NgTemplateOutlet,l.PaginationComponent,o.NgControlStatus,o.NgModel],styles:["tfoot.formio-grid-footer td{padding:.3rem}tfoot.formio-grid-footer .page-num{font-size:1.4em}tfoot.formio-grid-footer ul.pagination{margin-bottom:0;margin-top:5px}"],encapsulation:2});var H={header:y,body:O,footer:z},N=function(e,t){return{"glyphicon-triangle-top":e,"glyphicon-triangle-bottom":t}};function j(e,n){if(1&e&&t.ɵɵelement(0,"span",3),2&e){var o=t.ɵɵnextContext().$implicit;t.ɵɵproperty("ngClass",t.ɵɵpureFunction2(1,N,"asc"===o.sort,"desc"===o.sort))}}function G(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"th"),t.ɵɵelementStart(1,"a",1),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(o);var e=n.$implicit;return t.ɵɵnextContext(2).sort.emit(e)})),t.ɵɵtext(2),t.ɵɵtemplate(3,j,1,4,"span",2),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var r=n.$implicit;t.ɵɵadvance(2),t.ɵɵtextInterpolate1(" ",r.label," "),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.sort)}}function Q(e,n){if(1&e&&(t.ɵɵelementStart(0,"thead"),t.ɵɵelementStart(1,"tr"),t.ɵɵtemplate(2,G,4,2,"th",0),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e){var o=t.ɵɵnextContext();t.ɵɵadvance(2),t.ɵɵproperty("ngForOf",o.headers)}}var L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.load=function(e,t,n){var o=this;return t=t||{},e.loadForm({params:t}).then((function(e){return o.headers=[],o.formComponents=new Map,o.setComponents(e.components),n?n.forEach((function(e){o.setHeader(o.getHeaderForColumn(e,o.formComponents.get(e.path)))})):o.setComponentsHeaders(o.formComponents),o.headers}))},t.prototype.setHeader=function(e){this.headers.push(e)},t.prototype.getHeaderForColumn=function(e,t,n){return{label:e.label,key:e.path,sort:n,component:t?s.Components.create(t,null,null,!0):void 0,renderCell:e?e.renderCell:void 0}},t.prototype.getHeaderForComponent=function(e,t,n){return{label:e.label,key:t,sort:n,component:e?s.Components.create(e,null,null,!0):void 0}},t.prototype.setComponentsHeaders=function(e,t){var n=this;e.forEach((function(e,o){!e.input||e.hasOwnProperty("tableView")&&!e.tableView||n.setHeader(n.getHeaderForComponent(e,o,t))}))},t.prototype.setComponents=function(e){var t=this;s.Utils.eachComponent(e,(function(e,n){t.formComponents.set("data."+n,e)}))},t}(u);L.ɵfac=function(e){return _(e||L)},L.ɵcmp=t.ɵɵdefineComponent({type:L,selectors:[["ng-component"]],features:[t.ɵɵInheritDefinitionFeature],decls:1,vars:0,consts:[[4,"ngFor","ngForOf"],[3,"click"],["class","glyphicon",3,"ngClass",4,"ngIf"],[1,"glyphicon",3,"ngClass"]],template:function(e,n){1&e&&t.ɵɵtemplate(0,Q,3,1,"ng-template")},directives:[n.NgForOf,n.NgIf,n.NgClass],encapsulation:2});var _=t.ɵɵgetInheritedFactory(L);function D(e,n){if(1&e&&t.ɵɵelement(0,"td",3),2&e){var o=n.$implicit,r=t.ɵɵnextContext().$implicit,i=t.ɵɵnextContext(2);t.ɵɵproperty("innerHTML",i.view(r,o),t.ɵɵsanitizeHtml)}}function $(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"tr",1),t.ɵɵlistener("click",(function(e){t.ɵɵrestoreView(o);var r=n.$implicit;return t.ɵɵnextContext(2).onRowSelect(e,r)})),t.ɵɵtemplate(1,D,1,1,"td",2),t.ɵɵelementEnd()}if(2&e){var r=t.ɵɵnextContext(2);t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",r.header.headers)}}function B(e,n){if(1&e&&(t.ɵɵelementStart(0,"tbody"),t.ɵɵtemplate(1,$,2,1,"tr",0),t.ɵɵelementEnd()),2&e){var o=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",o.rows)}}var J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.load=function(e,t){var n=this;return t=t||{},e.loadSubmissions({params:t}).then((function(e){return n.setRows(t,e)}))},t.prototype.view=function(e,t){var n=a.get(e,t.key);return t.renderCell?t.renderCell(n,t.component):t.component?t.component.getView?t.component.getView(n):t.component.asString(n):n.toString()},t}(C);J.ɵfac=function(e){return U(e||J)},J.ɵcmp=t.ɵɵdefineComponent({type:J,selectors:[["ng-component"]],features:[t.ɵɵInheritDefinitionFeature],decls:1,vars:0,consts:[[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"innerHTML",4,"ngFor","ngForOf"],[3,"innerHTML"]],template:function(e,n){1&e&&t.ɵɵtemplate(0,B,2,1,"ng-template")},directives:[n.NgForOf],encapsulation:2});var U=t.ɵɵgetInheritedFactory(J);function W(e,n){if(1&e&&(t.ɵɵelementStart(0,"thead",3),t.ɵɵelementContainer(1,4),t.ɵɵelementEnd()),2&e){t.ɵɵnextContext(2);var o=t.ɵɵreference(3);t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",o)}}function K(e,n){if(1&e&&(t.ɵɵelementStart(0,"tfoot",3),t.ɵɵelementContainer(1,4),t.ɵɵelementEnd()),2&e){t.ɵɵnextContext(2);var o=t.ɵɵreference(3);t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",o)}}function X(e,n){if(1&e&&(t.ɵɵtemplate(0,W,2,1,"thead",2),t.ɵɵtemplate(1,K,2,1,"tfoot",2)),2&e){var o=n.position,r=t.ɵɵnextContext();t.ɵɵproperty("ngIf",o===r.footerPositions.top),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",o===r.footerPositions.bottom)}}function Y(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"button",11),t.ɵɵlistener("click",(function(){return t.ɵɵrestoreView(o),t.ɵɵnextContext(3).createItem.emit("form")})),t.ɵɵelement(1,"i",12),t.ɵɵtext(2),t.ɵɵelementEnd()}if(2&e){var r=t.ɵɵnextContext(3);t.ɵɵadvance(2),t.ɵɵtextInterpolate1(" ",r.createText,"")}}function Z(e,n){if(1&e){var o=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"td",6),t.ɵɵtemplate(1,Y,3,1,"button",7),t.ɵɵelementStart(2,"span",8),t.ɵɵelementStart(3,"span",9),t.ɵɵtext(4),t.ɵɵelementEnd(),t.ɵɵtext(5),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"pagination",10),t.ɵɵlistener("ngModelChange",(function(e){return t.ɵɵrestoreView(o),t.ɵɵnextContext(2).body.skip=e}))("pageChanged",(function(e){return t.ɵɵrestoreView(o),t.ɵɵnextContext(2).pageChanged.emit(e)})),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var r=t.ɵɵnextContext(2);t.ɵɵproperty("colSpan",r.header.numHeaders),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.actionAllowed("submissionCreate")&&r.createText),t.ɵɵadvance(3),t.ɵɵtextInterpolate2("",r.body.firstItem," - ",r.body.lastItem,""),t.ɵɵadvance(1),t.ɵɵtextInterpolate1(" / ",r.body.total," total"),t.ɵɵadvance(1),t.ɵɵproperty("totalItems",r.body.total)("itemsPerPage",r.body.limit)("ngModel",r.body.skip)("maxSize",r.size)}}function ee(e,n){if(1&e&&(t.ɵɵelementStart(0,"tr"),t.ɵɵtemplate(1,Z,7,9,"td",5),t.ɵɵelementEnd()),2&e){var o=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵproperty("ngIf",o.header)}}var te=function(e){function t(){return e.call(this)||this}return m(t,e),t.prototype.ngOnInit=function(){this.size||(this.size=7)},t}(A);te.ɵfac=function(e){return new(e||te)},te.ɵcmp=t.ɵɵdefineComponent({type:te,selectors:[["ng-component"]],features:[t.ɵɵInheritDefinitionFeature],decls:4,vars:0,consts:[["footer",""],["defaultFooterTemplate",""],["class","formio-grid-footer",4,"ngIf"],[1,"formio-grid-footer"],[3,"ngTemplateOutlet"],[3,"colSpan",4,"ngIf"],[3,"colSpan"],["class","btn btn-primary pull-left float-left",3,"click",4,"ngIf"],[1,"pull-right","float-right","item-counter"],[1,"page-num"],[1,"justify-content-center","pagination-sm",3,"totalItems","itemsPerPage","ngModel","maxSize","ngModelChange","pageChanged"],[1,"btn","btn-primary","pull-left","float-left",3,"click"],[1,"glyphicon","glyphicon-plus","fa","fa-plus"]],template:function(e,n){1&e&&(t.ɵɵtemplate(0,X,2,2,"ng-template",null,0,t.ɵɵtemplateRefExtractor),t.ɵɵtemplate(2,ee,2,1,"ng-template",null,1,t.ɵɵtemplateRefExtractor))},directives:[n.NgIf,n.NgTemplateOutlet,l.PaginationComponent,o.NgControlStatus,o.NgModel],styles:["tfoot.formio-grid-footer td{padding:.3rem}tfoot.formio-grid-footer .page-num{font-size:1.4em}tfoot.formio-grid-footer ul.pagination{margin-bottom:0;margin-top:5px}"],encapsulation:2});var ne={header:L,body:J,footer:te},oe=["headerTemplate"],re=["bodyTemplate"],ie=["footerTemplate"];function ae(e,t){}function se(e,t){}function le(e,t){}var ce=function(e){return{position:e}};function pe(e,n){if(1&e&&t.ɵɵelementContainer(0,9),2&e){var o=t.ɵɵnextContext();t.ɵɵproperty("ngTemplateOutlet",o.footer.template)("ngTemplateOutletContext",t.ɵɵpureFunction1(2,ce,o.footerPositions.top))}}function me(e,n){if(1&e&&t.ɵɵelementContainer(0,10),2&e){var o=t.ɵɵnextContext();t.ɵɵproperty("ngTemplateOutlet",o.header.template)}}function fe(e,n){if(1&e&&t.ɵɵelementContainer(0,10),2&e){var o=t.ɵɵnextContext();t.ɵɵproperty("ngTemplateOutlet",o.body.template)}}function ue(e,n){if(1&e&&t.ɵɵelementContainer(0,9),2&e){var o=t.ɵɵnextContext();t.ɵɵproperty("ngTemplateOutlet",o.footer.template)("ngTemplateOutletContext",t.ɵɵpureFunction1(2,ce,o.footerPositions.bottom))}}var de=function(e,t){return[e,t]},he=function(){function e(e,n,o){this.alerts=e,this.resolver=n,this.ref=o,this.footerPosition=c.bottom,this.page=0,this.isLoading=!1,this.initialized=!1,this.footerPositions=c,this.select=this.rowSelect=new t.EventEmitter,this.rowAction=new t.EventEmitter,this.createItem=new t.EventEmitter,this.error=new t.EventEmitter,this.isLoading=!0}return e.prototype.createComponent=function(e,t){var n=this.resolver.resolveComponentFactory(t);return e.createComponent(n).instance},e.prototype.loadGrid=function(e){var t=this;(e||this.formio)&&(this.formio&&this.src&&e===this.src||(e&&(this.src=e,this.formio=new i.FormioPromiseService(this.src,{formOnly:!0})),this.header.load(this.formio,{},this.columns).then((function(){return t.setPage(0)})).catch((function(e){return t.onError(e)}))))},e.prototype.ngOnInit=function(){var e=this,t=this.components||("form"===this.gridType?H:ne);this.header=this.createComponent(this.headerElement,t.header),this.header.actionAllowed=this.actionAllowed.bind(this),this.header.sort.subscribe((function(t){return e.sortColumn(t)})),this.body=this.createComponent(this.bodyElement,t.body),this.body.header=this.header,this.body.actionAllowed=this.actionAllowed.bind(this),this.body.rowSelect.subscribe((function(t){return e.rowSelect.emit(t)})),this.body.rowAction.subscribe((function(t){return e.rowAction.emit(t)})),this.footer=this.createComponent(this.footerElement,t.footer),this.footer.header=this.header,this.footer.body=this.body,this.footer.actionAllowed=this.actionAllowed.bind(this),this.footer.createText=this.createText,this.footer.size=this.size,this.footer.pageChanged.subscribe((function(t){return e.pageChanged(t)})),this.footer.createItem.subscribe((function(t){return e.createItem.emit(t)}))},e.prototype.ngOnChanges=function(e){this.initialized&&((e.src&&e.src.currentValue||e.formio&&e.formio.currentValue)&&this.loadGrid(e.src.currentValue),e.items&&e.items.currentValue&&this.refreshGrid()),this.footer&&e.createText&&e.createText.currentValue&&(this.footer.createText=e.createText.currentValue)},e.prototype.ngAfterViewInit=function(){var e=this;this.alerts.setAlerts([]),this.query=this.query||{},this.refresh&&this.refresh.subscribe((function(t){return e.refreshGrid(t)})),this.loadGrid(this.src),this.initialized=!0,this.ref.detectChanges()},e.prototype.actionAllowed=function(e){return!this.isActionAllowed||this.isActionAllowed(e)},e.prototype.onError=function(e){this.isLoading=!1,this.error.emit(e),this.alerts.setAlert({type:"danger",message:e})},e.prototype.refreshGrid=function(e){var t=this;this.alerts.setAlerts([]),this.query=e||this.query,this.query.hasOwnProperty("limit")||(this.query.limit=10),this.query.hasOwnProperty("skip")||(this.query.skip=0),this.isLoading=!0,this.ref.detectChanges(),s.Formio.cache={};return(this.items?Promise.resolve(this.body.setRows(this.query,this.items)):this.body.load(this.formio,this.query)).then((function(e){t.isLoading=!1,t.initialized=!0,t.ref.detectChanges()})).catch((function(e){return t.onError(e)}))},e.prototype.setPage=function(e){void 0===e&&(e=-1),this.page=-1!==e?e:this.page,this.query.hasOwnProperty("limit")||(this.query.limit=10),this.query.hasOwnProperty("skip")||(this.query.skip=0),this.query.skip=this.page*this.query.limit,this.refreshGrid()},e.prototype.sortColumn=function(e){switch(a.each(this.header.headers,(function(t){t.key!==e.key&&(t.sort="")})),e.sort){case"asc":e.sort=f.DESC,this.query.sort="-"+e.key;break;case"desc":e.sort=void 0,delete this.query.sort;break;case void 0:e.sort=f.ASC,this.query.sort=e.key}this.refreshGrid()},e.prototype.pageChanged=function(e){this.setPage(e.page-1)},e}();he.ɵfac=function(e){return new(e||he)(t.ɵɵdirectiveInject(i.FormioAlerts),t.ɵɵdirectiveInject(t.ComponentFactoryResolver),t.ɵɵdirectiveInject(t.ChangeDetectorRef))},he.ɵcmp=t.ɵɵdefineComponent({type:he,selectors:[["formio-grid"]],viewQuery:function(e,n){var o;(1&e&&(t.ɵɵstaticViewQuery(oe,!0,t.ViewContainerRef),t.ɵɵstaticViewQuery(re,!0,t.ViewContainerRef),t.ɵɵstaticViewQuery(ie,!0,t.ViewContainerRef)),2&e)&&(t.ɵɵqueryRefresh(o=t.ɵɵloadQuery())&&(n.headerElement=o.first),t.ɵɵqueryRefresh(o=t.ɵɵloadQuery())&&(n.bodyElement=o.first),t.ɵɵqueryRefresh(o=t.ɵɵloadQuery())&&(n.footerElement=o.first))},inputs:{footerPosition:"footerPosition",src:"src",items:"items",onForm:"onForm",query:"query",refresh:"refresh",columns:"columns",gridType:"gridType",size:"size",components:"components",formio:"formio",createText:"createText",isActionAllowed:"isActionAllowed"},outputs:{select:"select",rowSelect:"rowSelect",rowAction:"rowAction",createItem:"createItem",error:"error"},features:[t.ɵɵNgOnChangesFeature],decls:14,vars:12,consts:[["headerTemplate",""],["bodyTemplate",""],["footerTemplate",""],[1,"formio-grid"],[3,"alerts"],[1,"table","table-bordered","table-striped","table-hover"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[3,"ngTemplateOutlet",4,"ngIf"],[3,"isLoading"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngTemplateOutlet"]],template:function(e,n){1&e&&(t.ɵɵtemplate(0,ae,0,0,"ng-template",null,0,t.ɵɵtemplateRefExtractor),t.ɵɵtemplate(2,se,0,0,"ng-template",null,1,t.ɵɵtemplateRefExtractor),t.ɵɵtemplate(4,le,0,0,"ng-template",null,2,t.ɵɵtemplateRefExtractor),t.ɵɵelementStart(6,"div",3),t.ɵɵelement(7,"formio-alerts",4),t.ɵɵelementStart(8,"table",5),t.ɵɵtemplate(9,pe,1,4,"ng-container",6),t.ɵɵtemplate(10,me,1,1,"ng-container",7),t.ɵɵelement(11,"formio-loader",8),t.ɵɵtemplate(12,fe,1,1,"ng-container",7),t.ɵɵtemplate(13,ue,1,4,"ng-container",6),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e&&(t.ɵɵadvance(7),t.ɵɵproperty("alerts",n.alerts),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",n.initialized&&-1!==t.ɵɵpureFunction2(6,de,n.footerPositions.top,n.footerPositions.both).indexOf(n.footerPosition)),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.initialized),t.ɵɵadvance(1),t.ɵɵproperty("isLoading",n.isLoading),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.initialized),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.initialized&&-1!==t.ɵɵpureFunction2(9,de,n.footerPositions.bottom,n.footerPositions.both).indexOf(n.footerPosition)))},directives:[i.FormioAlertsComponent,n.NgIf,i.FormioLoaderComponent,n.NgTemplateOutlet],styles:[".formio-grid[_ngcontent-%COMP%]{position:relative;width:100%}.grid-refresh[_ngcontent-%COMP%]{height:400px;width:100%}"]});var ge=function(){};ge.ɵmod=t.ɵɵdefineNgModule({type:ge}),ge.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||ge)},providers:[i.FormioAlerts],imports:[[n.CommonModule,o.FormsModule,i.FormioModule,r.RouterModule,l.PaginationModule.forRoot()]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(ge,{declarations:[he,y,O,z,L,J,te],imports:[n.CommonModule,o.FormsModule,i.FormioModule,r.RouterModule,l.PaginationModule],exports:[he]}),e.FormGridBodyComponent=O,e.FormGridFooterComponent=z,e.FormGridHeaderComponent=y,e.FormioGrid=ge,e.FormioGridComponent=he,e.GridBodyComponent=C,e.GridFooterComponent=A,e.GridHeaderComponent=u,e.SubmissionGridBodyComponent=J,e.SubmissionGridFooterComponent=te,e.SubmissionGridHeaderComponent=L,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-formio-grid.umd.min.js.map